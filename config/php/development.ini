; PHP Development Configuration
; Optimized for EC Site API Development

; Error Handling
display_errors = On
display_startup_errors = On
error_reporting = E_ALL
log_errors = On
error_log = /var/log/apache2/php_errors.log
ignore_repeated_errors = Off
ignore_repeated_source = Off

; Performance Settings
memory_limit = 512M
max_execution_time = 300
max_input_time = 300
max_input_vars = 3000
post_max_size = 64M
upload_max_filesize = 64M
file_uploads = On
max_file_uploads = 20

; Output Control
output_buffering = 4096
output_compression = On
implicit_flush = Off

; Date/Time
date.timezone = "Asia/Tokyo"

; Character Set
default_charset = "UTF-8"
; mbstring.internal_encoding is deprecated in PHP 8.2
; mbstring.http_output is deprecated in PHP 8.2
mbstring.encoding_translation = Off
mbstring.detect_order = "UTF-8,EUC-JP,SJIS,JIS"
mbstring.substitute_character = "none"

; Session Configuration
session.auto_start = 0
session.cookie_lifetime = 0
session.cookie_path = "/"
session.cookie_domain = ""
session.cookie_secure = 0
session.cookie_httponly = 1
session.cookie_samesite = "Lax"
session.use_strict_mode = 1
session.use_cookies = 1
session.use_only_cookies = 1
session.name = "EC_SESSID"
session.save_handler = "files"
session.gc_maxlifetime = 7200
session.gc_probability = 1
session.gc_divisor = 100

; Database (MySQL/PDO)
mysql.default_socket = "/var/run/mysqld/mysqld.sock"
mysqli.default_socket = "/var/run/mysqld/mysqld.sock"
pdo_mysql.default_socket = "/var/run/mysqld/mysqld.sock"

; Security Settings
expose_php = Off
allow_url_fopen = On
allow_url_include = Off
enable_dl = Off
sql.safe_mode = Off

; Mail Configuration (Mailpit)
SMTP = "mailpit"
smtp_port = 1025
sendmail_path = "/usr/sbin/sendmail -t -i -S mailpit:1025"
mail.add_x_header = On

; JSON Settings
json.decode.max_depth = 512

; Opcache Settings
opcache.enable = 1
opcache.enable_cli = 1
opcache.memory_consumption = 128
opcache.interned_strings_buffer = 8
opcache.max_accelerated_files = 4000
opcache.revalidate_freq = 0
opcache.validate_timestamps = 1
opcache.enable_file_override = 0
opcache.fast_shutdown = 1

; Xdebug Configuration (Development)
xdebug.mode = debug,develop
xdebug.client_host = host.docker.internal
xdebug.client_port = 9003
xdebug.start_with_request = yes
xdebug.log_level = 0

; GD Library
gd.jpeg_ignore_warning = 1

; File Permissions
; user_dir = 
; open_basedir = 

; Magic Quotes (deprecated)
magic_quotes_gpc = Off
magic_quotes_runtime = Off
magic_quotes_sybase = Off

; Resource Limits
max_input_nesting_level = 64
max_input_time = 300
memory_limit = 512M

; CGI Settings
cgi.fix_pathinfo = 0

; FastCGI Settings
fastcgi.impersonate = 1
fastcgi.logging = 0

; Other Settings
short_open_tag = Off
asp_tags = Off
precision = 14
serialize_precision = -1
zend.enable_gc = On
zend.assertions = 1
assert.active = 1
assert.warning = 1
assert.bail = 0
assert.callback = 0

; Extensions specific settings
; Redis
redis.session.locking_enabled = 1
redis.session.lock_expire = 30
redis.session.lock_wait_time = 50000

; MySQLi
mysqli.max_persistent = -1
mysqli.allow_persistent = On
mysqli.max_links = -1
mysqli.cache_size = 2000
mysqli.default_port = 3306
mysqli.default_user = 
mysqli.default_pw = 
mysqli.reconnect = Off

; PDO
pdo_mysql.cache_size = 2000
pdo_mysql.default_socket = "/var/run/mysqld/mysqld.sock"